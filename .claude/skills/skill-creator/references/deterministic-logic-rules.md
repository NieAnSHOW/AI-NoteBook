# 确定性逻辑识别规则

判断逻辑应封装为脚本还是保留在指令中的标准。

## 三问判断法

对于每个步骤，问三个问题：
1. 需要 Agent 理解上下文吗？
2. 需要 Agent 做判断吗？
3. 需要 Agent 生成内容吗？

**三个问题都答"否" → 封装为脚本**

## 分类对照表

### 应封装为脚本 ✅

| 逻辑类型 | 示例 |
|----------|------|
| 数学计算 | 财务比率、统计公式 |
| 数据验证 | 格式校验、完整性检查 |
| 文件处理 | 批量重命名、格式转换 |
| 模板生成 | 固定格式输出 |
| 批量操作 | 循环下载、批量转换 |
| 状态管理 | 进度跟踪、结果统计 |
| 资源管理 | 初始化、清理 |

### 保留在指令中 ❌

| 逻辑类型 | 示例 |
|----------|------|
| 意图理解 | 用户需求分析 |
| 内容创作 | 文档撰写、代码设计 |
| 决策判断 | 方案选择、质量评估 |
| 场景识别 | 路径选择 |
| 异常处理 | 人工决策 |

## 设计决策流程图

```
分析任务步骤
    ↓
需要理解/判断? ──是──→ 保留在 SKILL.md
    ↓否
有固定算法? ──是──→ 封装为 Script
    ↓否
是重复性操作? ──是──→ 封装为 Script
    ↓否
保留在 SKILL.md
```

## Agent 解析 + 脚本执行模式

**核心原则**：Agent 负责理解和解析用户意图，脚本负责执行确定性操作。

### ❌ 错误：Agent 执行批量操作

```markdown
Step 1: 循环处理每个视频
Step 2: 下载视频文件
Step 3: 保存结果统计
```

### ✅ 正确：Agent 解析，脚本执行

```markdown
Step 1: 解析录制列表为 JSON (Agent 思考)
   - 从用户输入提取录制信息
   - 生成 down_list.json

Step 2: 执行批量下载 (脚本执行)
   - 执行脚本：`python download.py --json_file down_list.json`
   - 脚本自动完成：循环处理、下载、进度跟踪、结果统计
```
