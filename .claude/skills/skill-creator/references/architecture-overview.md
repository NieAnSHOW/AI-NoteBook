# DDD 四层架构概览

Skills 遵循领域驱动设计（DDD）的四层架构模式。

## 架构图

```
┌─────────────────────────────────────────────────────────────┐
│                      SKILL.md                                │
│  ┌─────────────────────────────────────────────────────────┐│
│  │ Interface 层 (YAML Frontmatter)                         ││
│  │ - name: 触发标识                                         ││
│  │ - description: 匹配机制                                  ││
│  └─────────────────────────────────────────────────────────┘│
│  ┌─────────────────────────────────────────────────────────┐│
│  │ Application 层 (Decision Workflow)                      ││
│  │ - 场景识别 (Scenario Recognition)                        ││
│  │ - 路径编排 (Path Orchestration)                          ││
│  └─────────────────────────────────────────────────────────┘│
│  ┌─────────────────────────────────────────────────────────┐│
│  │ Domain 层 (Task Workflow)                               ││
│  │ - Task 定义与执行                                        ││
│  │ - Dimensions / Workflows / Steps                        ││
│  └─────────────────────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│                 Infrastructure 层 (独立文件)                 │
│  ┌───────────────┐ ┌───────────────┐ ┌───────────────┐      │
│  │   scripts/    │ │  references/  │ │    assets/    │      │
│  │ 确定性逻辑    │ │ 支撑信息      │ │ 静态资源      │      │
│  └───────────────┘ └───────────────┘ └───────────────┘      │
└─────────────────────────────────────────────────────────────┘
```

## 各层职责

| 层级 | 载体 | 职责 | 类比 |
|------|------|------|------|
| **Interface** | YAML Frontmatter | 触发机制：接收请求，决定是否激活 | Config |
| **Application** | SKILL.md Body | 路径编排：场景识别，工作流调度 | run.py |
| **Domain** | SKILL.md Body | 逻辑执行：封装业务规则，执行具体任务 | modules/ |
| **Infrastructure** | 独立文件 | 具体实现：脚本、参考资料、静态资产 | Utils/Resources |

## 渐进式披露

三级加载机制优化 Token 使用：

| 级别 | 内容 | 加载时机 | Token 消耗 |
|------|------|----------|------------|
| Level 1 | name + description | 启动时 | ~100 |
| Level 2 | SKILL.md Body | 匹配成功后 | ~5k |
| Level 3 | scripts/references/assets | 按需 | 无浪费 |
